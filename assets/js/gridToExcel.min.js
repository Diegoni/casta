
Ext.ux.GridPrinter={print:function(grid,title){try{var columns=grid.getColumnModel().config;var data=[];var body='';grid.store.data.each(function(item){var convertedData=[];var rowIndex=grid.getStore().indexOf(item);if(grid.getView().getRow(rowIndex).style.display!='none'){body+='<tr>';var ct=0;Ext.each(columns,function(column){if(column.hidden!==true){var key=column.dataIndex;var value=item.data[column.dataIndex]
value=column.renderer?column.renderer(value,null,item):value;if(value==null)
value='';body+='<td>'+value+'</td>';ct++;}},this);body+='</tr>';if(grid.preview!=null){body+='<tr><td colspan="'+ct+'"><div class="nopagebreak">'+grid.preview(item)+'</div></td></tr>';}}});var headings='<tr>';Ext.each(columns,function(column){if(column.hidden!==true){headings+='<th>'+column.header+'</th>';}},this);headings+='</tr>';if(title==null){title=grid.title;}
var html=new Ext.XTemplate('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">','<html>','<head>','<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />','<link href="'+Ext.ux.GridPrinter.stylesheetPath+'" rel="stylesheet" type="text/css" media="screen,print" />','<title>'+title+'</title>','</head>','<body>','<table>',headings,body,'</table>','</body>','</html>').apply(data);return html;}
catch(e)
{console.dir(e);return null;}},stylesheetPath:'/stylesheets/print.css',headerTpl:new Ext.XTemplate('<tr>','<tpl for=".">','<th>{header}</th>','</tpl>','</tr>')};